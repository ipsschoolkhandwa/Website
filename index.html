<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Public School Khandwa - Admissions Open</title>
    <meta name="google-site-verification" content="5P7gTd-X7NELQdW50jK26u2PPitEoSKabX-UENcl82I" />
    <meta name="google-site-verification" content="4D-EQu61VEgJCrJE2vWp0HtPpX8aGR2jESoRAeD9ysU" />
    <meta name="description" content="Indian Public School Khandwa ‚Äì Admissions open for Nursery class. Quality education, experienced teachers, and child-friendly environment in Khandwa.">

    <!-- Manifest for PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#004aad">

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="logo-hq.png">

    <!-- PWA Mobile Config -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Preload HQ logo for better performance -->
    <link rel="preload" href="logo-hq.png" as="image" type="image/png">
    <link rel="preload" href="logo.png" as="image" type="image/png">
    <link rel="preload" href="style.css" as="style">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Montserrat:wght@800;900&display=swap" rel="stylesheet">

    <!-- Disable selection -->
    <style>
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .phone, .phone *, .toast {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        img {
            -webkit-user-drag: none;
            user-drag: none;
            pointer-events: none;
        }

        /* Heart icon must be clickable */
        #heartTrigger {
            pointer-events: auto !important;
            cursor: pointer !important;
            position: relative !important;
            z-index: 10000 !important;
        }
    </style>
</head>
<body>
    <!-- Hearts Container for Animation -->
    <div id="hearts-container"></div>

    <!-- Love Filter Overlay -->
    <div id="love-filter"></div>

    <div class="container">
        <!-- Header with Logo on left and School Name on right -->
        <div class="header">
            <div class="header-content">
                <div class="logo-section">
                    <!-- Smart picture element: HQ for good screens, normal for others -->
                    <picture>
                        <!-- High-res logo for Retina/4K screens -->
                        <source srcset="logo-hq.png" media="(min-width: 768px) and (min-resolution: 2dppx)">
                        <!-- Medium screens -->
                        <source srcset="logo.png" media="(min-width: 480px)">
                        <!-- Default/fallback for all -->
                        <img src="logo.png" 
                             alt="Indian Public School Logo" 
                             class="logo" 
                             id="schoolLogo"
                             crossorigin="anonymous" 
                             loading="eager" 
                             width="140" 
                             height="140"
                             srcset="logo.png 512w, logo-hq.png 1024w"
                             sizes="(max-width: 768px) 140px, 140px">
                    </picture>
                    <div class="logo-ring"></div>
                    <div class="logo-glow"></div>

                    <!-- Backside of Logo for PWA Install -->
                    <div class="logo-backside" id="logoBackside">
                        <div class="logo-back-content">
                            <svg width="60" height="60" viewBox="0 0 24 24" fill="#004aad" class="install-icon">
                                <path d="M19,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12.74,13.31L11.26,12.83L9.2,11.83C9.2,11.83 8.55,11.53 8.35,11.13C8.15,10.73 8.18,10.13 8.62,9.79C9.06,9.45 9.8,9.53 10.31,9.93L12.03,11.26L13.76,9.87C14.27,9.47 15,9.4 15.45,9.76C15.9,10.12 15.97,10.76 15.77,11.17C15.57,11.58 14.93,11.9 14.93,11.9L13.25,12.79L12.74,13.31M14.69,14.34C14.69,14.34 13.74,15.05 12.77,15.11C11.8,15.17 10.84,14.44 10.71,14.32C10.58,14.2 9.55,13.34 8.82,13.39C8.09,13.44 7.34,14.31 7.34,14.31L6.71,16.47C6.71,16.47 8.23,17.59 10.15,17.58C12.07,17.57 13.5,16.45 13.5,16.45L14.69,14.34Z"/>
                            </svg>
                            <p class="install-hint">Click to install</p>
                            <button class="install-btn" id="installBtn">
                                <i class="fas fa-download"></i> Install Now
                            </button>
                        </div>
                    </div>
                </div>
                <div class="school-info">
                    <div class="school-name">
                        <span class="indian">Indian</span>
                        <span class="public">Public</span>
                        <span class="school-text">School</span>
                    </div>
                    <div class="school-location">
                        <span class="khandwa">KHANDWA</span>
                    </div>
                    <p class="tagline">Creating Good Humans</p>
                </div>
            </div>
        </div>

        <!-- Admission Badge at Top -->
        <div class="admission-top-badge">
            <div class="badge-top-content">
                <i class="fas fa-graduation-cap"></i>
                <span>Admissions Open</span>
                <i class="fas fa-child"></i>
            </div>
        </div>

        <div class="admission-box">
            <h2>Registration for Nursery Class</h2>
            <div class="icon"><i class="fas fa-child"></i></div>
            <p class="admission-note">Limited seats available. Early registration recommended.</p>
        </div>

        <div class="contact-box">
            <h3><i class="fas fa-phone"></i> Contact for Admission</h3>

            <div class="phone">
                <i class="fas fa-mobile-alt"></i>
                <span>+91 7333574759</span>
            </div>

            <div class="buttons">
                <button class="call-btn" id="callBtn">
                    <i class="fas fa-phone"></i> Call Now
                </button>
                <button class="copy-btn" id="copyBtn">
                    <i class="far fa-copy"></i> Copy Number
                </button>
            </div>

            <div class="warning" id="officeHours">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Office Hours: 9:00 AM to 12:00 Noon</p>
            </div>
        </div>

        <div class="info-box">
            <div class="info-item">
                <i class="fas fa-map-marker-alt"></i>
                <div>
                    <h4>Address</h4>
                    <p>Housing Board Colony, Nagchun Road, Khandwa</p>
                </div>
            </div>

            <div class="info-item">
                <i class="far fa-clock"></i>
                <div>
                    <h4>Form Timing</h4>
                    <p>Available at school office: 9 AM to 12 Noon</p>
                </div>
            </div>

            <div class="info-item">
                <i class="fas fa-file-alt"></i>
                <div>
                    <h4>Registration</h4>
                    <p>Visit school office for forms</p>
                </div>
            </div>
        </div>

        <div class="youtube-box">
            <i class="fab fa-youtube"></i>
            <p>Visit our YouTube Channel</p>
            <a href="https://youtube.com/@indianpublicschoolkhandwa5876" target="_blank" id="youtubeLink">
                Watch School Videos
            </a>
        </div>

        <div class="footer">
            <div class="footer-logo">
                <span class="footer-indian">Indian</span>
                <span class="footer-public">Public</span>
                <span class="footer-school">School</span>
            </div>
            <p>¬© 2024 Indian Public School Khandwa</p>
            <p class="seats">Limited seats available for Nursery Class</p>
            <p class="tech-note">Built with <span class="heart-icon" id="heartTrigger">‚ù§Ô∏è</span> by IPS Student</p>
            <p class="secret-hint"><small></small></p>
        </div>

        <div class="toast" id="toast"></div>
    </div>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js?v=2.0');
            });
        }
    </script>

    <!-- Main Script -->
    <script src="script.js"></script>

    <!-- Inline Script for PWA Installation and Heart Animation -->
    <script>
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Heart animation functionality
            const heartTrigger = document.getElementById('heartTrigger');
            const heartsContainer = document.getElementById('hearts-container');
            const loveFilter = document.getElementById('love-filter');
            let heartsActive = false;

            if (!heartTrigger) {
                console.error('Heart trigger element not found!');
                return;
            }

            // Ensure heart icon is clickable
            heartTrigger.style.pointerEvents = 'auto';
            heartTrigger.style.cursor = 'pointer';
            heartTrigger.style.position = 'relative';
            heartTrigger.style.zIndex = '10000';

            heartTrigger.addEventListener('click', function(e) {
                e.stopPropagation();
                e.preventDefault();

                if (heartsActive) return;

                heartsActive = true;

                // Create initial love burst
                createLoveBurst(e.clientX || window.innerWidth/2, e.clientY || window.innerHeight/2);

                // Activate love filter with delay
                setTimeout(() => {
                    if (loveFilter) loveFilter.classList.add('active');
                    document.body.classList.add('love-mode');
                }, 100);

                // Create LOTS of hearts - Different sizes and types
                const heartCount = 150;
                const heartColors = [
                    '#ff4757', '#ff6b81', '#ff3838', '#ff9ff3', 
                    '#f368e0', '#ffcccc', '#ff9999', '#ff6666',
                    '#ff3388', '#ff00aa', '#ff1493', '#ff69b4'
                ];

                for (let i = 0; i < heartCount; i++) {
                    setTimeout(() => createHeart(i, heartColors), i * 20);
                }

                // Reset after 6 seconds
                setTimeout(() => {
                    if (heartsContainer) heartsContainer.innerHTML = '';
                    if (loveFilter) loveFilter.classList.remove('active');
                    document.body.classList.remove('love-mode');

                    heartsActive = false;
                }, 6000);
            });

            function createHeart(index, colors) {
                if (!heartsContainer) return;

                const heart = document.createElement('div');
                heart.className = 'falling-heart';

                // Random properties
                const sizeType = Math.random();
                let size = 30;

                if (sizeType < 0.3) {
                    size = 20;
                } else if (sizeType < 0.6) {
                    size = 30;
                } else if (sizeType < 0.85) {
                    size = 45;
                } else {
                    size = 60;
                }

                // Random position
                const left = Math.random() * 100;
                const delay = Math.random() * 2;
                const duration = 3 + Math.random() * 3;

                // Random color
                const colorIndex = Math.floor(Math.random() * colors.length);
                const color = colors[colorIndex];

                // Apply styles
                heart.style.left = `${left}%`;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
                heart.style.fontSize = `${size}px`;
                heart.style.color = color;
                heart.style.opacity = '0.9';
                heart.style.zIndex = '9999';

                // Add heart emoji
                heart.innerHTML = '‚ù§Ô∏è';

                heartsContainer.appendChild(heart);

                // Remove heart after animation
                setTimeout(() => {
                    if (heart.parentNode === heartsContainer) {
                        heart.remove();
                    }
                }, (duration + delay) * 1000);
            }

            function createLoveBurst(x, y) {
                const burst = document.createElement('div');
                burst.className = 'love-burst';
                burst.style.left = `${x - 50}px`;
                burst.style.top = `${y - 50}px`;
                burst.style.position = 'fixed';

                document.body.appendChild(burst);

                setTimeout(() => {
                    if (burst.parentNode) {
                        burst.remove();
                    }
                }, 1000);
            }

            // Toast function
            function showToast(message) {
                const toast = document.getElementById('toast');
                if (!toast) return;

                toast.textContent = message;
                toast.style.background = 'linear-gradient(135deg, #ff6b81, #ff4757)';
                toast.classList.add('show');

                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }

            // Logo spin and PWA functionality - FIXED: Single smooth spin
            const schoolLogo = document.getElementById('schoolLogo');
            const logoBackside = document.getElementById('logoBackside');
            const installBtn = document.getElementById('installBtn');
            let logoFlipped = false;
            let isAnimating = false;
            let deferredPrompt = null;

            if (schoolLogo && logoBackside) {
                // Fix: Make sure logo is above backside
                schoolLogo.style.zIndex = '2';
                logoBackside.style.zIndex = '1';

                schoolLogo.addEventListener('click', function(e) {
                    e.stopPropagation();
                    e.preventDefault();

                    if (isAnimating) return;
                    isAnimating = true;

                    if (!logoFlipped) {
                        // First click: Show backside - Single smooth 360 spin
                        console.log('First click - showing backside');

                        // Add single 360 spin animation
                        schoolLogo.style.animation = 'singleLogoSpin 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards';

                        setTimeout(() => {
                            // Hide front logo
                            schoolLogo.style.opacity = '0';
                            schoolLogo.style.visibility = 'hidden';
                            schoolLogo.style.animation = '';

                            // Show backside
                            logoBackside.style.opacity = '1';
                            logoBackside.style.visibility = 'visible';
                            logoBackside.style.display = 'flex';

                            logoFlipped = true;
                            isAnimating = false;
                        }, 800);
                    } else {
                        // Second click: Show frontside
                        flipToFront();
                    }
                });
            }

            // Click anywhere to flip back
            document.addEventListener('click', function(e) {
                if (logoFlipped && logoBackside && !logoBackside.contains(e.target) && e.target !== schoolLogo && e.target !== installBtn) {
                    flipToFront();
                }
            });

            function flipToFront() {
                if (!logoBackside || !schoolLogo || isAnimating) return;

                isAnimating = true;
                console.log('Flipping to front');

                // Hide backside
                logoBackside.style.opacity = '0';
                logoBackside.style.visibility = 'hidden';
                logoBackside.style.display = 'none';

                // Show front logo with reverse spin
                schoolLogo.style.animation = 'singleLogoSpinReverse 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards';
                setTimeout(() => {
                    schoolLogo.style.opacity = '1';
                    schoolLogo.style.visibility = 'visible';
                    schoolLogo.style.animation = '';
                    
                    logoFlipped = false;
                    isAnimating = false;
                }, 800);
            }

            // PWA Installation - FIXED: Use browser's native PWA prompt
            window.addEventListener('beforeinstallprompt', function(e) {
                e.preventDefault();
                deferredPrompt = e;
                console.log('‚úÖ PWA install prompt available');
                
                // Show install button
                if (installBtn) {
                    installBtn.style.display = 'flex';
                }
            });

            // Install button click handler - FIXED: Trigger native PWA install
            if (installBtn) {
                installBtn.addEventListener('click', async function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                    
                    console.log('üì± Install button clicked');
                    
                    if (deferredPrompt) {
                        console.log('üöÄ Triggering native PWA install prompt');
                        deferredPrompt.prompt();
                        
                        const choiceResult = await deferredPrompt.userChoice;
                        console.log('User choice:', choiceResult.outcome);
                        
                        if (choiceResult.outcome === 'accepted') {
                            showToast('‚úÖ App installed successfully!');
                        } else {
                            showToast('‚ùå App installation cancelled');
                        }
                        
                        deferredPrompt = null;
                        flipToFront();
                    } else {
                        console.log('‚ö†Ô∏è No install prompt available');
                        showToast('‚ö†Ô∏è Install feature not available in this browser');
                        flipToFront();
                    }
                });
            }

            // Call and copy buttons functionality
            const callBtn = document.getElementById('callBtn');
            const copyBtn = document.getElementById('copyBtn');

            if (callBtn) {
                callBtn.addEventListener('click', function() {
                    window.location.href = 'tel:+917333574759';
                });
            }

            if (copyBtn) {
                copyBtn.addEventListener('click', function() {
                    const phoneNumber = '+917333574759';
                    navigator.clipboard.writeText(phoneNumber).then(function() {
                        showToast('Phone number copied to clipboard!');
                    }).catch(function(err) {
                        console.error('Failed to copy: ', err);
                        showToast('Failed to copy number');
                    });
                });
            }
        });
    </script>

    <!-- Chat widget -->
    <script src="//code.tidio.co/k7fzqvwdesmz8nerm3zlgofwutxh0lkq.js" async></script>

    <!-- Events System -->
    <script src="event/event-install.js" defer></script>
</body>
</html>